"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{4480:function(t,e,n){n.d(e,{Z:function(){return b}});var r=n(5666),a=n.n(r),o=n(5893),c=n(1163),i=n(7294),s=n(9608),u=n(842);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var d=function(t){var e=t.tagList,n=t.addTag,r=t.removeTag,a=l(i.useState(""),2),c=a[0],s=a[1],d=function(){c&&(n(c),s(""))};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("fieldset",{className:"form-group",children:[(0,o.jsx)("input",{className:"form-control",type:"text",placeholder:u.isDemo?"Press Enter, Tab or Comma to add a tag":"Enter tags",value:c,onChange:function(t){return s(t.target.value)},onBlur:d,onKeyDown:function(t){switch(t.keyCode){case 13:case 9:case 188:9!==t.keyCode&&t.preventDefault(),d()}}}),(0,o.jsx)("div",{className:"tag-list",children:e.map((function(t,e){return(0,o.jsxs)("span",{className:"tag-default tag-pill",children:[(0,o.jsx)("i",{className:"ion-close-round",onClick:function(){return function(t){r(t)}(t)}}),t]},e)}))})]})})},f=n(2280),p=n(5014),v=n(1682);function h(t,e,n,r,a,o,c){try{var i=t[o](c),s=i.value}catch(u){return void n(u)}i.done?e(s):Promise.resolve(s).then(r,a)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){g(t,e,n[e])}))}return t}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function x(t,e){switch(e.type){case"SET_TITLE":return m({},t,{title:e.text});case"SET_DESCRIPTION":return m({},t,{description:e.text});case"SET_BODY":return m({},t,{body:e.text});case"ADD_TAG":return m({},t,{tagList:t.tagList.concat(e.tag)});case"REMOVE_TAG":return m({},t,{tagList:t.tagList.filter((function(t){return t!==e.tag}))});default:throw new Error("Unhandled action")}}function b(t){var e=void 0!==t&&t;return function(t){var n,r=t.article;n=r?{title:r.title,description:r.description,body:r.body,tagList:r.tagList}:{title:"",description:"",body:"",tagList:[]};var u,l=y(i.useState(!1),2),g=l[0],m=l[1],b=y(i.useState([]),2),j=b[0],w=b[1],T=y(i.useReducer(x,n),2),E=T[0],N=T[1],P=(0,p.Z)(),C=(0,c.useRouter)(),k=(u=a().mark((function t(n){var r,o,i,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),m(!0),!e){t.next=13;break}return t.next=7,f.Z.create(E,null===P||void 0===P?void 0:P.token);case 7:i=t.sent,r=i.data,o=i.status,t.next=20;break;case 13:return t.next=16,f.Z.update(E,C.query.pid,null===P||void 0===P?void 0:P.token);case 16:s=t.sent,r=s.data,o=s.status;case 20:m(!1),200!==o&&w(r.errors),c.default.push("/article/".concat(r.article.slug));case 23:case"end":return t.stop()}}),t)})),function(){var t=this,e=arguments;return new Promise((function(n,r){var a=u.apply(t,e);function o(t){h(a,n,r,o,c,"next",t)}function c(t){h(a,n,r,o,c,"throw",t)}o(void 0)}))});(0,v.hy)(k);var O=i.useContext(v.Il).setTitle;return i.useEffect((function(){O(e?"New article":"Editing: ".concat(null===r||void 0===r?void 0:r.title))}),[O,null===r||void 0===r?void 0:r.title]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"editor-page",children:(0,o.jsx)("div",{className:"container page",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsxs)("div",{className:"col-md-10 offset-md-1 col-xs-12",children:[(0,o.jsx)(s.Z,{errors:j}),(0,o.jsx)("form",{children:(0,o.jsxs)("fieldset",{children:[(0,o.jsx)("fieldset",{className:"form-group",children:(0,o.jsx)("input",{className:"form-control form-control-lg",type:"text",placeholder:"Article Title",value:E.title,onChange:function(t){return N({type:"SET_TITLE",text:t.target.value})}})}),(0,o.jsx)("fieldset",{className:"form-group",children:(0,o.jsx)("input",{className:"form-control",type:"text",placeholder:"What's this article about?",value:E.description,onChange:function(t){return N({type:"SET_DESCRIPTION",text:t.target.value})}})}),(0,o.jsx)("fieldset",{className:"form-group",children:(0,o.jsx)("textarea",{className:"form-control",rows:8,placeholder:"Write your article (in markdown)",value:E.body,onChange:function(t){return N({type:"SET_BODY",text:t.target.value})}})}),(0,o.jsx)(d,{tagList:E.tagList,addTag:function(t){return N({type:"ADD_TAG",tag:t})},removeTag:function(t){return N({type:"REMOVE_TAG",tag:t})}}),(0,o.jsxs)("button",{className:"btn btn-lg pull-xs-right btn-primary",type:"button",disabled:g,onClick:k,children:[e?"Publish":"Update"," Article"]})]})})]})})})})})}}},9608:function(t,e,n){var r=n(5893);n(7294);e.Z=function(t){var e=t.errors;return(0,r.jsx)("ul",{className:"error-messages",children:Object.keys(e).map((function(t){return(0,r.jsxs)("li",{children:[t,":",(0,r.jsx)("ul",{children:(0,r.jsx)("li",{children:e[t]})})]},t)}))})}},2280:function(t,e,n){var r=n(5666),a=n.n(r),o=n(9669),c=n.n(o),i=n(842);function s(t,e,n,r,a,o,c){try{var i=t[o](c),s=i.value}catch(u){return void n(u)}i.done?e(s):Promise.resolve(s).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function c(t){s(o,r,a,c,i,"next",t)}function i(t){s(o,r,a,c,i,"throw",t)}c(void 0)}))}}var l=function(t,e){return"limit=".concat(t,"&offset=").concat(e?e*t:0)},d={all:function(t,e){var n=void 0===e?10:e;return c().get("".concat(i.apiPath,"/articles?").concat(l(n,t)))},byAuthor:function(t,e,n){var r=void 0===e?0:e,a=void 0===n?5:n;return c().get("".concat(i.apiPath,"/articles?author=").concat(encodeURIComponent(t),"&").concat(l(a,r)))},byTag:function(t,e,n){var r=void 0===e?0:e,a=void 0===n?10:n;return c().get("".concat(i.apiPath,"/articles?tag=").concat(encodeURIComponent(t),"&").concat(l(a,r)))},delete:function(t,e){return c().delete("".concat(i.apiPath,"/articles/").concat(t),{headers:{Authorization:"Token ".concat(e)}})},favorite:function(t){return c().post("".concat(i.apiPath,"/articles/").concat(t,"/favorite"))},favoritedBy:function(t,e){return c().get("".concat(i.apiPath,"/articles?favorited=").concat(encodeURIComponent(t),"&").concat(l(10,e)))},feed:function(t,e){var n=void 0===e?10:e;return c().get("".concat(i.apiPath,"/articles/feed?").concat(l(n,t)))},get:function(t){return c().get("".concat(i.apiPath,"/articles/").concat(encodeURIComponent(t)))},unfavorite:function(t){return c().delete("".concat(i.apiPath,"/articles/").concat(t,"/favorite"))},update:u(a().mark((function t(e,n,r){var o,s,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c().put("".concat(i.apiPath,"/articles/").concat(n),JSON.stringify({article:e}),{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(encodeURIComponent(r))}});case 2:return o=t.sent,s=o.data,u=o.status,t.abrupt("return",{data:s,status:u});case 6:case"end":return t.stop()}}),t)}))),create:u(a().mark((function t(e,n){var r,o,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c().post("".concat(i.apiPath,"/articles"),JSON.stringify({article:e}),{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(encodeURIComponent(n))}});case 2:return r=t.sent,o=r.data,s=r.status,t.abrupt("return",{data:o,status:s});case 6:case"end":return t.stop()}}),t)})))};e.Z=d}}]);