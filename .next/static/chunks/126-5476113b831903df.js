"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[126],{3923:function(e,t,r){r.d(t,{Z:function(){return C}});var n=r(5893),a=r(1163),i=r(7294),c=r(9505),o=r(7954),s=r(297),l=r(5352),u=r(7059),f=r(9139),d=function(e){var t=e.article,r=t;if(t)return(0,n.jsxs)("div",{className:"article-preview",children:[(0,n.jsxs)("div",{className:"article-meta",children:[(0,n.jsx)(o.Z,{href:f.Z.userView(r.author.username),children:(0,n.jsx)(s.Z,{src:r.author.image,alt:"author profile image"})}),(0,n.jsxs)("div",{className:"info",children:[(0,n.jsx)(o.Z,{href:f.Z.userView(r.author.username),className:"author",children:r.author.username}),(0,n.jsx)("span",{className:"date",children:(0,u.p)(r.createdAt)})]}),(0,n.jsx)("div",{className:"pull-xs-right",children:(0,n.jsx)(l.Z,{favorited:r.favorited,favoritesCount:r.favoritesCount,slug:r.slug})})]}),(0,n.jsxs)(o.Z,{href:f.Z.articleView(r.slug),className:"preview-link",children:[(0,n.jsx)("h1",{children:r.title}),(0,n.jsx)("p",{children:r.description}),(0,n.jsx)("span",{children:"Read more..."}),(0,n.jsx)("ul",{className:"tag-list",children:r.tagList.map((function(e,t){return(0,n.jsx)("li",{className:"tag-default tag-pill tag-outline",children:e},t)}))})]})]})},v=r(842),h=r(8929),m=r(9435),p=r(6209);function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function j(e){var t,r=Object.assign({},e);return delete r.children,delete r.className,t=e.className?" "+e.className:"",(0,n.jsx)("li",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){g(e,t,r[t])}))}return e}({className:"page-item".concat(t)},r,{children:(0,n.jsx)("a",{className:"link page-link",children:e.children})}))}function w(e,t){return function(r){r.preventDefault(),e(t)}}var b=function(e){var t=e.articlesCount,r=e.articlesPerPage,a=e.showPagesMax,i=e.currentPage,c=e.setCurrentPage,o=Math.ceil(t/r);i>o&&(i=o);var s=Math.max(0,i-Math.floor(a/2)),l=Math.min(o-1,i+Math.floor(a/2));l-s+1<a&&(i<o/2?l=Math.min(o-1,l+(a-(l-s))):s=Math.max(0,s-(a-(l-s)))),l-s+1>a&&(i>o/2?s+=1:l-=1);var u,f=t>0?(u=s,x(Array(l-u+1)).map((function(e,t){return u+t}))):[],d=w(c,0),v=w(c,i-1),h=w(c,i+1),m=w(c,o-1);return(0,n.jsx)("nav",{children:(0,n.jsxs)("ul",{className:"pagination",children:[(0,n.jsx)(p.Z,{test:s>0,children:(0,n.jsx)(j,{onClick:d,children:"<<"})}),(0,n.jsx)(p.Z,{test:i>0,children:(0,n.jsx)(j,{onClick:v,children:"<"})}),f.map((function(e){var t=i?e===i:0===e;return(0,n.jsx)(j,{className:t&&"active",onClick:w(c,e),children:e+1},e.toString())})),(0,n.jsx)(p.Z,{test:i<o-1,children:(0,n.jsx)(j,{onClick:h,children:">"})}),(0,n.jsx)(p.Z,{test:l<o-1,children:(0,n.jsx)(j,{onClick:m,children:">>"})})]})})},y=r(8751);function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(r.push(c.value),!t||r.length!==t);n=!0);}catch(s){a=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var C=function(e){var t,r=e.articles,o=e.articlesCount,s=e.loggedInUser,u=e.page,f=e.setPage,g=e.what,x=e.ssr,j=e.tag,w=void 0===j?void 0:j,C=(0,a.useRouter)().query.pid,P=0===u&&(s&&"feed"===g||!s&&"global"===g),N=function(){if(void 0===s||x&&P)return null;switch(g){case"favorites":return"".concat(v.apiPath,"/articles?limit=").concat(v.articleLimit,"&favorited=").concat(encodeURIComponent(String(C)),"&offset=").concat(u*v.articleLimit);case"my-posts":return"".concat(v.apiPath,"/articles?limit=").concat(v.articleLimit,"&author=").concat(encodeURIComponent(String(C)),"&offset=").concat(u*v.articleLimit);case"tag":return"".concat(v.apiPath,"/articles?limit=").concat(v.articleLimit,"&tag=").concat(encodeURIComponent(w),"&offset=").concat(u*v.articleLimit);case"feed":return"".concat(v.apiPath,"/articles/feed?limit=").concat(v.articleLimit,"&offset=").concat(u*v.articleLimit);case"global":return"".concat(v.apiPath,"/articles?limit=").concat(v.articleLimit,"&offset=").concat(u*v.articleLimit);case void 0:return null;default:throw new Error("Unknown search: ".concat(g))}}(),Z=(0,c.ZP)(N,(0,y.Z)()),L=Z.data,S=Z.error,O=!0;L?(r=(t=L).articles,o=t.articlesCount):!x&&0===u&&"feed"!==g&&"tag"!==g||x&&(P||void 0===s)?O=!1:(r=[],o=0);for(var A=[],F=[],M=[],T=[],E=0;E<v.articleLimit;E++){var I,U;I=k(i.useState(!1),2),A[E]=I[0],F[E]=I[1],U=k(i.useState(0),2),M[E]=U[0],T[E]=U[1]}return i.useEffect((function(){for(var e=(null===r||void 0===r?void 0:r.length)||0,t=0;t<e;t++)F[t](r[t].favorited),T[t](r[t].favoritesCount)}),Object.assign(r.map((function(e){return e.favorited})).concat(r.map((function(e){return e.favoritesCount}))),{length:v.articleLimit})),S?(0,n.jsx)(h.Z,{message:"Cannot load recent articles..."}):!L&&O?(0,n.jsx)(m.Z,{}):0===(null===r||void 0===r?void 0:r.length)?(0,n.jsx)("div",{className:"article-preview",children:"No articles are here... yet."}):(0,n.jsxs)(n.Fragment,{children:[null===r||void 0===r?void 0:r.map((function(e,t){return(0,n.jsx)(l.F.Provider,{value:{favorited:A[t],setFavorited:F[t],favoritesCount:M[t],setFavoritesCount:T[t]},children:(0,n.jsx)(d,{article:e},e.slug)},e.slug)})),(0,n.jsx)(p.Z,{test:o&&o>v.articleLimit,children:(0,n.jsx)(b,{articlesCount:o,articlesPerPage:v.articleLimit,showPagesMax:10,currentPage:u,setCurrentPage:f})})]})}},8929:function(e,t,r){var n=r(5893);r(7294);t.Z=function(e){var t=e.message;return(0,n.jsx)("div",{className:"error-message",children:(0,n.jsx)("div",{className:"error-message-presenter",children:t})})}},5352:function(e,t,r){r.d(t,{F:function(){return v}});var n=r(5666),a=r.n(n),i=r(5893),c=r(9669),o=r.n(c),s=r(7294),l=r(1163),u=r(842),f=r(5014);function d(e,t,r,n,a,i,c){try{var o=e[i](c),s=o.value}catch(l){return void r(l)}o.done?t(s):Promise.resolve(s).then(n,a)}var v=s.createContext(void 0);t.Z=function(e){var t,r=(0,f.Z)(),n=s.useContext(v),c=n.favorited,h=n.setFavorited,m=n.favoritesCount,p=n.setFavoritesCount;t=e.showText?" "+(t=c?"Unfavorite":"Favorite")+" Article ":"";var g,x=(g=a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return l.default.push("/user/login"),t.abrupt("return");case 3:if(h((function(e){return!e})),p((function(e){return e+(c?-1:1)})),t.prev=5,!c){t.next=11;break}return t.next=9,o().delete("".concat(u.apiPath,"/articles/").concat(e.slug,"/favorite"),{headers:{Authorization:"Token ".concat(null===r||void 0===r?void 0:r.token)}});case 9:t.next=13;break;case 11:return t.next=13,o().post("".concat(u.apiPath,"/articles/").concat(e.slug,"/favorite"),{},{headers:{Authorization:"Token ".concat(null===r||void 0===r?void 0:r.token)}});case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(5),h((function(e){return!e})),p((function(e){return e+(c?1:-1)}));case 19:case"end":return t.stop()}}),t,null,[[5,15]])})),function(){var e=this,t=arguments;return new Promise((function(r,n){var a=g.apply(e,t);function i(e){d(a,r,n,i,c,"next",e)}function c(e){d(a,r,n,i,c,"throw",e)}i(void 0)}))}),j=m;return e.showText&&(j=(0,i.jsxs)("span",{className:"counter",children:["(",j,")"]})),(0,i.jsxs)("button",{className:c?"btn btn-sm btn-primary":"btn btn-sm btn-outline-primary",onClick:function(){return x()},children:[(0,i.jsx)("i",{className:"ion-heart"}),e.showText?" ":"",t," ",j]})}},9435:function(e,t,r){var n=r(5893);r(7294);t.Z=function(){return(0,n.jsx)("div",{className:"loading-spinner"})}},8751:function(e,t,r){r.d(t,{Z:function(){return l}});var n=r(5666),a=r.n(n),i=r(9669),c=r.n(i);function o(e,t,r,n,a,i,c){try{var o=e[i](c),s=o.value}catch(l){return void r(l)}o.done?t(s):Promise.resolve(s).then(n,a)}var s=function(){if(!window.localStorage.user)return{};if(0===Object.keys(window.localStorage.user).length)return{};var e=JSON.parse(window.localStorage.user);return e.token?{headers:{Authorization:"Token ".concat(e.token)}}:void 0};function l(e){var t,r=void 0!==e&&e;return t=a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=5;break}return e.next=3,c().get(t,s());case 3:return n=e.sent.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})),function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function c(e){o(i,n,a,c,s,"next",e)}function s(e){o(i,n,a,c,s,"throw",e)}c(void 0)}))}}},7059:function(e,t,r){function n(e){var t=new Date(e),r=t.toLocaleString("default",{month:"long"});return"".concat(r," ").concat(t.getDate(),", ").concat(t.getFullYear())}r.d(t,{p:function(){return n}})}}]);