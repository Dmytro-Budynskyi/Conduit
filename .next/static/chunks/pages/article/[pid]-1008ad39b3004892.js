(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{347:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/article/[pid]",function(){return n(7356)}])},5352:function(t,e,n){"use strict";n.d(e,{F:function(){return f}});var r=n(5666),a=n.n(r),o=n(5893),i=n(9669),c=n.n(i),s=n(7294),u=n(1163),l=n(842),d=n(5014);function v(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}var f=s.createContext(void 0);e.Z=function(t){var e,n=(0,d.Z)(),r=s.useContext(f),i=r.favorited,h=r.setFavorited,m=r.favoritesCount,p=r.setFavoritesCount;e=t.showText?" "+(e=i?"Unfavorite":"Favorite")+" Article ":"";var x,j=(x=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return u.default.push("/user/login"),e.abrupt("return");case 3:if(h((function(t){return!t})),p((function(t){return t+(i?-1:1)})),e.prev=5,!i){e.next=11;break}return e.next=9,c().delete("".concat(l.apiPath,"/articles/").concat(t.slug,"/favorite"),{headers:{Authorization:"Token ".concat(null===n||void 0===n?void 0:n.token)}});case 9:e.next=13;break;case 11:return e.next=13,c().post("".concat(l.apiPath,"/articles/").concat(t.slug,"/favorite"),{},{headers:{Authorization:"Token ".concat(null===n||void 0===n?void 0:n.token)}});case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),h((function(t){return!t})),p((function(t){return t+(i?1:-1)}));case 19:case"end":return e.stop()}}),e,null,[[5,15]])})),function(){var t=this,e=arguments;return new Promise((function(n,r){var a=x.apply(t,e);function o(t){v(a,n,r,o,i,"next",t)}function i(t){v(a,n,r,o,i,"throw",t)}o(void 0)}))}),w=m;return t.showText&&(w=(0,o.jsxs)("span",{className:"counter",children:["(",w,")"]})),(0,o.jsxs)("button",{className:i?"btn btn-sm btn-primary":"btn btn-sm btn-outline-primary",onClick:function(){return j()},children:[(0,o.jsx)("i",{className:"ion-heart"}),t.showText?" ":"",e," ",w]})}},8302:function(t,e,n){"use strict";n.d(e,{n:function(){return s}});var r=n(5893),a=n(7294),o=n(1163),i=n(7161),c=n(5014),s=a.createContext(void 0);e.Z=function(t){var e=t.profile,n=(0,c.Z)(),u=a.useContext(s),l=u.following,d=u.setFollowing,v=e.username,f=n&&v===(null===n||void 0===n?void 0:n.username);if(n&&f)return null;return(0,r.jsxs)("button",{className:"btn btn-sm action-btn ".concat(l?"btn-secondary":"btn-outline-secondary"),onClick:function(t){t.preventDefault(),n?(l?i.Z.unfollow(v):i.Z.follow(v),d(!l)):o.default.push("/user/login")},children:[(0,r.jsx)("i",{className:"ion-plus-round"})," \xa0"," ",l?"Unfollow":"Follow"," ",v]})}},9435:function(t,e,n){"use strict";var r=n(5893);n(7294);e.Z=function(){return(0,r.jsx)("div",{className:"loading-spinner"})}},2280:function(t,e,n){"use strict";var r=n(5666),a=n.n(r),o=n(9669),i=n.n(o),c=n(842);function s(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){s(o,r,a,i,c,"next",t)}function c(t){s(o,r,a,i,c,"throw",t)}i(void 0)}))}}var l=function(t,e){return"limit=".concat(t,"&offset=").concat(e?e*t:0)},d={all:function(t,e){var n=void 0===e?10:e;return i().get("".concat(c.apiPath,"/articles?").concat(l(n,t)))},byAuthor:function(t,e,n){var r=void 0===e?0:e,a=void 0===n?5:n;return i().get("".concat(c.apiPath,"/articles?author=").concat(encodeURIComponent(t),"&").concat(l(a,r)))},byTag:function(t,e,n){var r=void 0===e?0:e,a=void 0===n?10:n;return i().get("".concat(c.apiPath,"/articles?tag=").concat(encodeURIComponent(t),"&").concat(l(a,r)))},delete:function(t,e){return i().delete("".concat(c.apiPath,"/articles/").concat(t),{headers:{Authorization:"Token ".concat(e)}})},favorite:function(t){return i().post("".concat(c.apiPath,"/articles/").concat(t,"/favorite"))},favoritedBy:function(t,e){return i().get("".concat(c.apiPath,"/articles?favorited=").concat(encodeURIComponent(t),"&").concat(l(10,e)))},feed:function(t,e){var n=void 0===e?10:e;return i().get("".concat(c.apiPath,"/articles/feed?").concat(l(n,t)))},get:function(t){return i().get("".concat(c.apiPath,"/articles/").concat(encodeURIComponent(t)))},unfavorite:function(t){return i().delete("".concat(c.apiPath,"/articles/").concat(t,"/favorite"))},update:u(a().mark((function t(e,n,r){var o,s,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i().put("".concat(c.apiPath,"/articles/").concat(n),JSON.stringify({article:e}),{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(encodeURIComponent(r))}});case 2:return o=t.sent,s=o.data,u=o.status,t.abrupt("return",{data:s,status:u});case 6:case"end":return t.stop()}}),t)}))),create:u(a().mark((function t(e,n){var r,o,s;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i().post("".concat(c.apiPath,"/articles"),JSON.stringify({article:e}),{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(encodeURIComponent(n))}});case 2:return r=t.sent,o=r.data,s=r.status,t.abrupt("return",{data:o,status:s});case 6:case"end":return t.stop()}}),t)})))};e.Z=d},8751:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=n(5666),a=n.n(r),o=n(9669),i=n.n(o);function c(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}var s=function(){if(!window.localStorage.user)return{};if(0===Object.keys(window.localStorage.user).length)return{};var t=JSON.parse(window.localStorage.user);return t.token?{headers:{Authorization:"Token ".concat(t.token)}}:void 0};function u(t){var e,n=void 0!==t&&t;return e=a().mark((function t(e){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=5;break}return t.next=3,i().get(e,s());case 3:return r=t.sent.data,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(t){c(o,r,a,i,s,"next",t)}function s(t){c(o,r,a,i,s,"throw",t)}i(void 0)}))}}},7059:function(t,e,n){"use strict";function r(t){var e=new Date(t),n=e.toLocaleString("default",{month:"long"});return"".concat(n," ").concat(e.getDate(),", ").concat(e.getFullYear())}n.d(e,{p:function(){return r}})},7356:function(t,e,n){"use strict";n.r(e),n.d(e,{__N_SSG:function(){return z},default:function(){return O}});var r=n(5893),a=n(7084),o=n.n(a),i=(n(1664),n(1163)),c=n(7294),s=n(9505),u=n(5666),l=n.n(u),d=n(5352),v=n(8302),f=n(7954),h=n(6209),m=n(2280),p=n(842),x=n.n(p),j=n(5014),w=n(9139);function g(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}var b=function(t){var e,n,a=t.article,o=(0,j.Z)(),c=(0,i.useRouter)().query.pid,u=(n=l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}return t.abrupt("return");case 2:if(window.confirm("Do you really want to delete it?")){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,m.Z.delete(c,null===o||void 0===o?void 0:o.token);case 7:(0,s.X$)("".concat(x(),"/articles/").concat(c)),i.default.push("/");case 9:case"end":return t.stop()}}),t)})),function(){var t=this,e=arguments;return new Promise((function(r,a){var o=n.apply(t,e);function i(t){g(o,r,a,i,c,"next",t)}function c(t){g(o,r,a,i,c,"throw",t)}i(void 0)}))}),p=o&&(null===o||void 0===o?void 0:o.username)===(null===a||void 0===a||null===(e=a.author)||void 0===e?void 0:e.username);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{test:!p,children:(0,r.jsxs)("span",{children:[(0,r.jsx)(v.Z,{profile:a.author}),(0,r.jsx)(d.Z,{favorited:a.favorited,favoritesCount:a.favoritesCount,slug:a.slug,showText:!0})]})}),(0,r.jsx)(h.Z,{test:p,children:(0,r.jsxs)("span",{children:[(0,r.jsxs)(f.Z,{href:w.Z.articleEdit(a.slug),className:"btn btn-outline-secondary btn-sm",children:[(0,r.jsx)("i",{className:"ion-edit"})," Edit Article"]}),(0,r.jsxs)("button",{className:"btn btn-outline-danger btn-sm",onClick:u,children:[(0,r.jsx)("i",{className:"ion-trash-a"})," Delete Article"]})]})})]})},y=n(297),N=n(7059),k=function(t){var e,n,a,o,i=t.article;if(i)return(0,r.jsxs)("div",{className:"article-meta",children:[(0,r.jsx)(f.Z,{href:w.Z.userView(encodeURIComponent(null===(e=i.author)||void 0===e?void 0:e.username)),children:(0,r.jsx)(y.Z,{src:null===(n=i.author)||void 0===n?void 0:n.image,alt:"author profile image"})}),(0,r.jsxs)("div",{className:"info",children:[(0,r.jsx)(f.Z,{href:w.Z.userView(encodeURIComponent(null===(a=i.author)||void 0===a?void 0:a.username)),className:"author",children:null===(o=i.author)||void 0===o?void 0:o.username}),(0,r.jsx)("span",{className:"date",children:(0,N.p)(i.createdAt)})]}),(0,r.jsx)(b,{article:i})]})},P=n(9669),Z=n.n(P);function C(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}var T=function(t){var e,n=t.commentId,a=(0,j.Z)(),o=(0,i.useRouter)().query.pid,c=(e=l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z().delete("".concat(p.apiPath,"/articles/").concat(o,"/comments/").concat(e),{headers:{Authorization:"Token ".concat(null===a||void 0===a?void 0:a.token)}});case 2:(0,s.X$)("".concat(p.apiPath,"/articles/").concat(o,"/comments"));case 3:case"end":return t.stop()}}),t)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(t){C(o,r,a,i,c,"next",t)}function c(t){C(o,r,a,i,c,"throw",t)}i(void 0)}))});return(0,r.jsx)("span",{className:"mod-options",children:(0,r.jsx)("i",{className:"ion-trash-a",onClick:function(){return c(n)}})})},F=function(t){var e,n=t.comment,a=(0,j.Z)(),o=a&&(null===a||void 0===a?void 0:a.username)===(null===n||void 0===n||null===(e=n.author)||void 0===e?void 0:e.username);return(0,r.jsxs)("div",{className:"card",children:[(0,r.jsx)("div",{className:"card-block",children:n.body}),(0,r.jsxs)("div",{className:"card-footer",children:[(0,r.jsx)(f.Z,{href:w.Z.userView(n.author.username),className:"comment-author",children:(0,r.jsx)(y.Z,{src:n.author.image,alt:"author profile image",className:"comment-author-img"})}),"\xa0",(0,r.jsx)(f.Z,{href:w.Z.userView(n.author.username),className:"comment-author",children:n.author.username}),(0,r.jsx)("span",{className:"date-posted",children:(0,N.p)(n.createdAt)}),(0,r.jsx)(h.Z,{test:o,children:(0,r.jsx)(T,{commentId:n.id})})]})]})},S=n(1682);function A(t,e,n,r,a,o,i){try{var c=t[o](i),s=c.value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,a)}function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var _=function(){var t,e=(0,j.Z)(),n=(0,i.useRouter)().query.pid,a=I(c.useState(""),2),o=a[0],u=a[1],d=I(c.useState(!1),2),v=d[0],h=d[1],m=c.useCallback((function(t){u(t.target.value)}),[]),x=(t=l().mark((function t(r){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),h(!0),t.next=4,Z().post("".concat(p.apiPath,"/articles/").concat(encodeURIComponent(String(n)),"/comments"),JSON.stringify({comment:{body:o}}),{headers:{"Content-Type":"application/json",Authorization:"Token ".concat(encodeURIComponent(null===e||void 0===e?void 0:e.token))}});case 4:h(!1),u(""),(0,s.X$)("".concat(p.apiPath,"/articles/").concat(n,"/comments"));case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){A(o,r,a,i,c,"next",t)}function c(t){A(o,r,a,i,c,"throw",t)}i(void 0)}))});return(0,S.hy)(x),e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("ul",{className:"error-messages"}),(0,r.jsx)("form",{className:"card comment-form",onSubmit:x,children:(0,r.jsxs)("fieldset",{children:[(0,r.jsx)("div",{className:"card-block",children:(0,r.jsx)("textarea",{rows:3,className:"form-control",placeholder:"Write a comment...",value:o,onChange:m,disabled:v})}),(0,r.jsxs)("div",{className:"card-footer",children:[(0,r.jsx)(y.Z,{className:"comment-author-img",src:e.effectiveImage,alt:"author profile image"}),(0,r.jsx)("button",{className:"btn btn-sm btn-primary",type:"submit",children:"Post Comment"})]})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{href:w.Z.userLogin(),children:"Sign in"})," or"," ",(0,r.jsx)(f.Z,{href:w.Z.userNew(),children:"sign up"})," to add comments on this article."]})},R=n(9435),E=n(8751);function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(s){a=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var z=!0,O=function(t){var e,n=t.article,a=t.comments,u=(0,i.useRouter)(),l=(0,s.ZP)("".concat(p.apiPath,"/articles/").concat(null===n||void 0===n?void 0:n.slug),(0,E.Z)(u.isFallback)).data;void 0!==l&&(n=l.article);var f=(0,s.ZP)("".concat(p.apiPath,"/articles/").concat(null===n||void 0===n?void 0:n.slug,"/comments"),(0,E.Z)(u.isFallback)).data;void 0!==f&&(a=f.comments);var h=U(c.useState(!1),2),m=h[0],x=h[1];c.useEffect((function(){x(null===n||void 0===n?void 0:n.author.following)}),[null===n||void 0===n?void 0:n.author.following]);var j=U(c.useState(!1),2),w=j[0],g=j[1],b=U(c.useState(null===n||void 0===n?void 0:n.favoritesCount),2),y=b[0],N=b[1];c.useEffect((function(){g(null===n||void 0===n?void 0:n.favorited),N(null===n||void 0===n?void 0:n.favoritesCount)}),[null===n||void 0===n?void 0:n.favorited,null===n||void 0===n?void 0:n.favoritesCount]);var P=c.useContext(S.Il),Z=(P.setPage,P.setTab,P.setTag,P.setTitle);if(c.useEffect((function(){Z(null===n||void 0===n?void 0:n.title)}),[Z,null===n||void 0===n?void 0:n.title]),u.isFallback)return(0,r.jsx)(R.Z,{});var C={__html:o()(n.body)};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"article-page",children:[(0,r.jsx)("div",{className:"banner",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("h1",{children:n.title}),(0,r.jsx)(d.F.Provider,{value:{favorited:w,setFavorited:g,favoritesCount:y,setFavoritesCount:N},children:(0,r.jsx)(v.n.Provider,{value:{following:m,setFollowing:x},children:(0,r.jsx)(k,{article:n})})})]})}),(0,r.jsxs)("div",{className:"container page",children:[(0,r.jsx)("div",{className:"row article-content",children:(0,r.jsxs)("div",{className:"col-md-12",children:[(0,r.jsx)("div",{dangerouslySetInnerHTML:C}),(0,r.jsx)("ul",{className:"tag-list",children:null===(e=n.tagList)||void 0===e?void 0:e.map((function(t){return(0,r.jsxs)("li",{className:"tag-default tag-pill tag-outline",children:[t,!1]},t)}))})]})}),(0,r.jsx)("hr",{}),(0,r.jsx)("div",{className:"article-actions",children:(0,r.jsx)(d.F.Provider,{value:{favorited:w,setFavorited:g,favoritesCount:y,setFavoritesCount:N},children:(0,r.jsx)(v.n.Provider,{value:{following:m,setFollowing:x},children:(0,r.jsx)(k,{article:n})})})}),(0,r.jsx)("div",{className:"row",children:(0,r.jsx)("div",{className:"col-xs-12 col-md-8 offset-md-2",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(_,{}),null===a||void 0===a?void 0:a.map((function(t){return(0,r.jsx)(F,{comment:t},t.id)}))]})})})]})]})})}}},function(t){t.O(0,[84,774,888,179],(function(){return e=347,t(t.s=e);var e}));var e=t.O();_N_E=e}]);